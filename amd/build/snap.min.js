require.config({enforceDefine:!1,paths:{dependency:"TweenMax"}}),define(["jquery","theme_snap/bootstrap","core/log","theme_snap/headroom","theme_snap/util","theme_snap/personal_menu","theme_snap/responsive_video","theme_snap/cover_image","TweenLite"],function(e,t,o,n,a,i,r,s){"use strict";e=t,M.theme_snap=M.theme_snap||{};o.disableAll(!0);var c=function(e){var t=e.split("?");if(t.length<2)return!1;for(var o=t[1],n=(o=o.split("#")[0]).split("&"),a=[],i=0;i<n.length;i++){var r=n[i].split("="),s=r[0],c=r[1];a[s]=c}return a},d=function(){var t=e(".xdebug-error");if(t.length)for(var o=0;o<t.length;o++){var n=t[o].parentNode,a=e(n).prev("br");e(a).remove()}var i=e(".xdebug-error, .php-debug, .debuggingmessage");if(i.length){e(i).addClass("php-debug-footer");var r=e('<div id="footer-error-cont"><h3>'+M.util.get_string("debugerrors","theme_snap")+"</h3><hr></div>");e("#page-footer").append(r),e("#footer-error-cont").append(i),e(".php-debug-footer").after(e("<hr>")),e("#mr-nav").addClass("errors-found");var s=e('<a class="footer-error-link btn btn-danger" href="#footer-error-cont">'+M.util.get_string("problemsfound","theme_snap")+' <span class="badge">'+i.length+"</span></a>");e("#page-header").append(s)}},l=function(){return 0===e("body").attr("id").indexOf("page-course-view-")},p=function(){if(l()&&e(".block_adminblock form").each(function(){e(this).attr("action",e(this).attr("action")+"#coursetools")}),""===location.hash){var t=c(location.href);l()&&void 0!==t.time&&(location.hash="coursetools",e(".block_calendar_month")&&a.scrollToElement(e(".block_calendar_month")));var o=["body.path-blocks-collect #notice form"],n=["bui_deleteid","bui_editid"];for(var i in n)if(void 0!==t[n[i]]){o.push("#notice form");break}e(o.join(", ")).each(function(){var t=e(this).attr("action");-1===t.indexOf("#")&&t.indexOf("/course/view.php")>-1&&e(this).attr("action",e(this).attr("action")+"#coursetools")})}},u=function(){e(".path-mod-forum tr.discussion td.topic.starter").attr("data-cellname",M.util.get_string("forumtopic","theme_snap")),e(".path-mod-forum tr.discussion td.picture:not('.group')").attr("data-cellname",M.util.get_string("forumauthor","theme_snap")),e(".path-mod-forum tr.discussion td.picture.group").attr("data-cellname",M.util.get_string("forumpicturegroup","theme_snap")),e(".path-mod-forum tr.discussion td.replies").attr("data-cellname",M.util.get_string("forumreplies","theme_snap")),e(".path-mod-forum tr.discussion td.lastpost").attr("data-cellname",M.util.get_string("forumlastpost","theme_snap"))},m=function(e){return e=e.trim().toLowerCase()},h=function(t){var o,n=window.navigator.userAgent;(n.indexOf("MSIE ")||n.indexOf("Trident/"))&&(t=e("#toc-searchables").find("li").clone(!0));var a=e("#toc-search-input").val();if(0===(a=m(a)).length)e("#toc-search-results").html(""),e("#toc-search-input").removeClass("state-active");else{e("#toc-search-input").addClass("state-active");var i=[];for(o=0;o<t.length;o++){var r=t[o];m(e(r).text()).indexOf(a)>-1&&i.push(r)}e("#toc-search-results").html(i)}},f=function(){var t=[];e("#notice.snap-continue-cancel").length&&t.push("hascontinuecancel"),e("body").addClass(t.join(" "))},g=function(t){var n=location.hash;e(window).on("popstate hashchange",function(a){var r=location.hash;o.info("hashchange"),r!==n&&("#primary-nav"===location.hash?i.update():(e("#page, #moodle-footer, #js-personal-menu-trigger, #logo, .skiplinks").css("display",""),l()&&(o.info("show section",a.target),t.showSection()))),n=r})},v=function(t){e(t).show().animate({right:"20px",opacity:1},1e3)},b=function(t){e(t).animate({right:"-600px",opacity:.5},200,function(){e(t).hide()})},y=function(){v("#activitycompletemodal")},_=function(){e(".next_activity_overlay").fadeTo("slow",0,function(){e(this).hide()}),TweenLite.to(e("#darkBackground"),0,{display:"block"}),TweenLite.to(e("#darkBackground"),.3,{background:"rgba(0,0,0,0.4)",force3D:!0}),TweenLite.to(e("#alertBox"),0,{left:"calc(50% - 150px)",top:"calc(50% - 150px)",delay:"0.2"}),TweenLite.to(e("#alertBox"),0,{display:"block",opacity:1,delay:"0.2"}),TweenLite.to(e("#alertBox"),0,{display:"block",scale:.2,opacity:0,delay:"0.2"}),TweenLite.to(e("#alertBox"),.3,{opacity:1,force3D:!0,delay:"0.2"}),TweenLite.to(e("#alertBox"),.3,{scale:1,scale:1,force3D:!0,delay:"0.2"}),TweenLite.to(e("#darkBackground"),.2,{backgroundColor:"rgba(0,0,0,0)",force3D:!0,delay:"2"}),TweenLite.to(e("#darkBackground"),.2,{display:"none",force3D:!0,delay:"2"}),TweenLite.to(e("#alertBox"),.2,{opacity:0,display:"none",force3D:!0,delay:"2",onComplete:y})},w=function(){void 0!==M.snapTheme.settings.nextactivitymodaldialogdelay&&-1==["page","book","wiki"].indexOf(M.snapTheme.mod.modname)&&setTimeout(function(){_()},M.snapTheme.settings.nextactivitymodaldialogdelay)},k=function(){e(".hsuforum-reply").submit(function(e){setTimeout(function(){x()},3e3)})},x=function(){e("#completion-region");try{e.ajax({type:"GET",async:!0,url:M.cfg.wwwroot+"/theme/snap/rest.php?action=get_completion&contextid="+M.theme_snap.mod.context.id,success:function(t){e(".completion-region").attr("data-content-loaded","1"),e(".completion-region").html(t.html),w()}})}catch(e){console.write(e)}k()},T=function(){var t=[".chapters a",".section_footer a"," #toc-search-results a"];if(e(document).on("click",t.join(", "),function(t){var o=this.getAttribute("href");window.history&&window.history.pushState?(history.pushState(null,null,o),e(window).trigger("hashchange"),t.preventDefault()):location.hash=o}),e('[data-toggle="collapse"]').on("click",function(){e(this).find("span.glyphicon").toggleClass("glyphicon-chevron-down glyphicon-chevron-up")}),e(".completeclick").on("click",function(e){_(),e.preventDefault()}),e(".completeclose").on("click",function(e){b("#activitycompletemodal"),e.preventDefault()}),void 0!==M.snapTheme.settings&&null!=M.snapTheme.settings&&(void 0===M.snapTheme.settings.fixheadertotopofpage||"0"==M.snapTheme.settings.fixheadertotopofpage)){var o=document.querySelector("#mr-nav"),i=new n(o,{tolerance:5,offset:100,classes:{initial:"headroom",pinned:"headroom--pinned",unpinned:"headroom--unpinned",top:"headroom--top",notTop:"headroom--not-top"}});e(".notloggedin").length||i.init()}void 0!==M.snapTheme.mod&&null!=M.snapTheme.mod&&"hsuforum"==M.snapTheme.mod.modname&&k();var r=e("#toc-searchables").find("li").clone(!0);e("#course-toc").on("keyup","#toc-search-input",function(){h(r)}),e("#course-toc").on("keydown","#toc-search-input",function(t){9===(t.keyCode||t.which)&&e("#toc-search-results a").last().blur(function(){e(this).off("blur"),e("#toc-search-input").val(""),e("#toc-search-results").html(""),e("#toc-search-input").removeClass("state-active")})}),e("#course-toc").on("click","#toc-search-results a",function(){e("#toc-search-input").val(""),e("#toc-search-results").html(""),e("#toc-search-input").removeClass("state-active")}),e(document).on("click",function(t){e(t.target).closest("#toc-search-input").length||(e("#toc-search-input").val(""),e("#toc-search-results").html(""),e("#toc-search-input").removeClass("state-active"))}),e(document).on("click","#admin-menu-trigger, #toc-mobile-menu-toggle",function(t){var o=this.getAttribute("href");"admin-menu-trigger"==this.getAttribute("id")&&(e(this).toggleClass("active"),e("#page").toggleClass("offcanvas")),e(o).attr("tabindex","0"),e(o).toggleClass("state-visible").focus(),t.preventDefault()}),e(document).on("click","#course-toc.state-visible a",function(){e("#course-toc").removeClass("state-visible")}),e(document).on("click",".news-article .toggle",function(t){var o=e(this).closest(".news-article");a.scrollToElement(o),e(".news-article").not(o).removeClass("state-expanded"),e(".news-article-message").css("display","none"),o.toggleClass("state-expanded"),e(".state-expanded").find(".news-article-message").slideDown("fast",function(){o.is(".state-expanded")?(o.find(".news-article-message").focus(),o.attr("aria-expanded","true")):(o.focus(),o.attr("aria-expanded","false")),e(document).trigger("snapContentRevealed")}),t.preventDefault()}),e(function(){var t=!1;"ontouchstart"in window?t=!0:window.navigator.msPointerEnabled&&(t=!0),t||e('[data-toggle="tooltip"]').tooltip()})};return{snapInit:function(t,o,n,a,l,m){M.cfg.context=t.contextid,M.snapTheme={forcePassChange:a,settings:l,mod:m},i.init(),o&&require(["theme_snap/course-lazy"],function(e){var o=new e(t);g(o)}),e(document).ready(function(){if(d(),u(),T(),p(),f(),s(t.shortname,n),e("body").hasClass("snap-fixy-open")&&i.update(),e("#page-course-editsection.format-topics").length){var o=document.getElementById("id_usedefaultname"),a=document.getElementById("id_name");o.value="0",o.checked=!1,a.required="required",a.focus(),e("#id_name + span").css("display","none"),e("#id_cancel").on("click",function(){e("#id_name").removeAttr("required"),e("#mform1").submit()})}if(e("#page-mod-book-view").length){var l=c(location.href);e(".block_book_toc").append('<p><hr><a target="_blank" href="/mod/book/tool/print/index.php?id='+l.id+'">'+M.util.get_string("printbook","booktool_print")+"</a></p>")}var m=/^page-mod-.*-mod$/.test(e("body").attr("id"))&&location.href.indexOf("modedit")>-1,h="page-course-edit"===e("body").attr("id"),g="page-course-editsection"===e("body").attr("id"),v=-1===["page-mod-hvp-mod"].indexOf(e("body").attr("id"));if((m||h||g)&&v){var b=[":first","#page-course-edit #id_descriptionhdr","#id_contentsection","#id_general + #id_general","#id_content","#page-mod-choice-mod #id_optionhdr","#page-mod-assign-mod #id_availability","#page-mod-assign-mod #id_submissiontypes","#page-mod-workshop-mod #id_gradingsettings","#page-mod-choicegroup-mod #id_miscellaneoussettingshdr","#page-mod-choicegroup-mod #id_groups","#page-mod-scorm-mod #id_packagehdr"];b=b.join(),e("#mform1 > fieldset").not(b).wrapAll('<div class="snap-form-advanced col-md-4" />'),e(".snap-form-advanced").append(e(".collapsible-actions"));for(var y=e("#mform1 fieldset:first"),_=e("#mform1 fieldset:first .fcontainer"),w=e("#mform1 > fieldset").not("#mform1 > fieldset:first"),k=0;k<w.length;k++){var x=e(w[k]).find(".fcontainer");e(_).append(x),e(w[k]).remove()}e(y).wrap('<div class="snap-form-required col-md-8" />');var C=e("#mform1 fieldset:first .fitem_feditor:not(.required)");if(m&&C){var D="page-mod-assign-mod"==e("body").attr("id"),B="page-mod-choice-mod"==e("body").attr("id"),L="page-mod-turnitintool-mod"==e("body").attr("id"),q="page-mod-workshop-mod"==e("body").attr("id");B||D||L||q||(e(_).append(C),e(_).append(e("#fitem_id_showdescription")))}var O=e("#mform1 #fgroup_id_buttonar");e(y).append(O)}r.init(),e(window).on("load",function(){e("body").addClass("snap-js-loaded")})})},addPopCompletion:function(){w()},popCompletion:function(){_()}}});